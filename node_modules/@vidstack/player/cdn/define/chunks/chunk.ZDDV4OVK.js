import{a as b}from"./chunk.VDAPKEID.js";import{$ as y,B as v,a,b as u,g as c,i as r,m as h,oa as p,p as f,pa as g,qa as l}from"./chunk.DPV5XUTO.js";var n=new Set,d=!1,m=!1,i=class extends g{constructor(){super();this.singlePlayback=!1;this.syncVolume=!1;this.Z=new h;v(this,b,(e,s)=>{this.Kt(e,s)})}static get styles(){return p`:host{display:contents}`}disconnectedCallback(){super.disconnectedCallback(),this.Z.empty()}render(){return u`<slot></slot>`}get provider(){return this.r}Kt(e,s){this.r=e,n.add(e);let o=this.Ls();if(o&&(this.r.volume=o.volume,this.r.muted=o.muted),this.singlePlayback){let t=r(e,"vds-play",this.Ts.bind(this));this.Z.add(t)}if(this.syncVolume){let t=r(e,"vds-volume-change",c(this.ks.bind(this),10,!0));this.Z.add(t)}if(this.volumeStorageKey){let t=r(e,"vds-volume-change",this.Rs.bind(this));this.Z.add(t)}s(()=>{n.delete(e),this.r=void 0,this.Z.empty()})}Ts(){d||(d=!0,n.forEach(e=>{e!==this.r&&(e.paused=!0)}),d=!1)}ks(e){if(m)return;m=!0;let{volume:s,muted:o}=e.detail;n.forEach(t=>{t!==this.r&&(t.volume=s,t.muted=o)}),this.dispatchEvent(f("vds-media-volume-sync",{bubbles:!0,composed:!0,detail:e.detail})),m=!1}Ls(){if(!!this.volumeStorageKey)try{return JSON.parse(localStorage.getItem(this.volumeStorageKey))}catch{return}}Rs(e){!this.volumeStorageKey||localStorage.setItem(this.volumeStorageKey,JSON.stringify(e.detail))}};a([l({type:Boolean,attribute:"single-playback"})],i.prototype,"singlePlayback",2),a([l({type:Boolean,attribute:"sync-volume"})],i.prototype,"syncVolume",2),a([l({attribute:"volume-storage-key"})],i.prototype,"volumeStorageKey",2);y("vds-media-sync",i);
